buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:2.1.4.RELEASE")
    }
}

apply plugin: 'io.spring.dependency-management'
apply plugin: 'org.springframework.boot'
apply plugin: 'java-library'
apply plugin: 'eclipse'

sourceCompatibility = '1.8'
group = 'com.chestermere.lake.temperature'
version = '0.0.1-SNAPSHOT'

configurations {
    shade
    compile.extendsFrom shade
}

bootJar {
	mainClassName = 'com.chestermere.lake.temperature.Application'
    baseName = 'Server-Handler'
    version =  version
    manifest {
		attributes 'Start-Class': mainClassName
	}
}

repositories {
	mavenCentral()
	jcenter()
}

dependencies {

	// Spring
	implementation (group: 'org.springframework.boot', name: 'spring-boot-starter-web', version: '2.1.4.RELEASE')

	// Google Guava
	implementation (group: 'com.google.guava', name: 'guava', version: '27.1-jre')

	// H2 Database
	implementation (group: 'com.h2database', name: 'h2', version: '1.4.199')

	// JUnit
	testImplementation (group: 'junit', name: 'junit', version: '4.12')

	// Spring tests
	testCompile (group: 'org.springframework.boot', name: 'spring-boot-starter-test', version: '2.1.4.RELEASE')

}

jar {
	configurations.shade.each {dep ->
		from (project.zipTree(dep)) {
			exclude 'META-INF', 'META-INF/**'
		}
	}
}
